{% extends 'base.html' %}

{% block title %}Store | Const Collection{% endblock %}

{% block content %}
  <div class="container mt-4">
    <h2>Store</h2>
    {% if sale_items %}
      <div class="row">
        {% for art in sale_items %}
          <div class="col-md-4 mb-3">
            <div class="card h-100">
              {% if art.image %}
                <img src="{{ art.image.url }}" class="card-img-top" style="height:220px;object-fit:cover;" alt="{{ art.title }}">
              {% endif %}
              <div class="card-body">
                <h5 class="card-title">{{ art.title }}</h5>
                <p class="small text-muted">{{ art.collection.name }} â€” {{ art.collection.artist.name }}</p>

                <div class="mb-2">
                  {% if art.physical_available %}
                    <div>Physical: <strong>${{ art.physical_price }}</strong></div>
                  {% endif %}
                  {% if art.digital_available %}
                    <div>Digital: <strong>${{ art.digital_price }}</strong></div>
                  {% endif %}
                </div>

                <a href="{% url 'collections_app:art_detail' art.pk %}" class="btn btn-sm btn-outline-primary">View</a>
                {% if art.is_available and user.is_authenticated %}
                  <form method="post" action="{% url 'collections_app:add_to_basket' art.pk %}" style="display:inline;">
                    {% csrf_token %}
                    <input type="hidden" name="quantity" value="1">
                    <input type="hidden" name="next" value="{% url 'store_app:index' %}">
                    <button type="submit" class="btn btn-sm btn-success ms-1">
                      <i class="bi bi-cart-plus"></i> Add to Basket
                    </button>
                  </form>
                {% elif not user.is_authenticated %}
                  <a href="{% url 'account_login' %}?next={% url 'store_app:index' %}" class="btn btn-sm btn-success ms-1">
                    <i class="bi bi-cart-plus"></i> Login to Purchase
                  </a>
                {% endif %}
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p>No items for sale right now.</p>
    {% endif %}
  </div>
{% endblock %}
