{% extends 'base.html' %}

{% block content %}
  <div class="container mt-4">
    <h1>{% if edit %}Edit Artwork{% else %}Add New Artwork{% endif %}</h1>
    <p class="text-muted">You can create a new collection inline if needed.</p>
    <div class="card">
      <div class="card-body">
        {% if created_collection %}
          <div class="alert alert-success">Created collection: <strong>{{ created_collection.name }}</strong></div>
        {% endif %}

        <div class="mb-3">
          <a class="btn btn-sm btn-outline-secondary" data-bs-toggle="collapse" href="#newCollection" role="button" aria-expanded="false" aria-controls="newCollection">Create new collection</a>
        </div>

        <div class="collapse mb-3" id="newCollection">
          <div class="card card-body">
            <form method="post" enctype="multipart/form-data">
              {% csrf_token %}
              {{ collection_form.as_p }}
              <button name="create_collection" value="1" class="btn btn-primary btn-sm" type="submit">Create collection</button>
            </form>
          </div>
        </div>

        <form method="post" enctype="multipart/form-data">
          {% csrf_token %}
          <div class="row">
            <div class="col-md-8">
              <div class="mb-3">
                {{ form.collection.label_tag }}
                {{ form.collection }}
                {{ form.collection.errors }}
              </div>

              <div class="mb-3">
                {{ form.title.label_tag }}
                {{ form.title }}
                {{ form.title.errors }}
              </div>

              <div class="mb-3">
                {{ form.description.label_tag }}
                {{ form.description }}
                {{ form.description.errors }}
              </div>

              <div class="row">
                <div class="col-md-4 mb-3">
                  {{ form.medium.label_tag }}
                  {{ form.medium }}
                  {{ form.medium.errors }}
                </div>
                <div class="col-md-2 mb-3">
                  {{ form.year_created.label_tag }}
                  {{ form.year_created }}
                  {{ form.year_created.errors }}
                </div>
                <div class="col-md-3 mb-3">
                  {{ form.width_cm.label_tag }}
                  {{ form.width_cm }}
                  {{ form.width_cm.errors }}
                </div>
                <div class="col-md-3 mb-3">
                  {{ form.height_cm.label_tag }}
                  {{ form.height_cm }}
                  {{ form.height_cm.errors }}
                </div>
              </div>

              <div class="mb-3">
                {{ form.image.label_tag }}
                {{ form.image }}
                {{ form.image.errors }}
              </div>

            </div>

            <div class="col-md-4">
                <div class="card">
                  <div class="card-body p-3">
                    <h5>Store & Visibility</h5>

                    <div class="mb-3">


                  <div class="form-check mb-2">
                    {{ form.is_featured }}
                    {{ form.is_featured.label_tag }}
                    {{ form.is_featured.errors }}
                  </div>

                  <hr />
                  <h6>Per-format pricing</h6>
                  <div class="mb-2">
                    <div class="d-flex align-items-start">
                      <div class="form-check me-2">
                        {{ form.original_available }}
                      </div>
                      <div class="flex-grow-1">
                        <label class="form-label mb-1">Original Piece</label>
                        <div class="d-flex align-items-center">
                          {{ form.original_price }}
                          <div class="ms-2 small text-muted">{{ form.currency }}</div>
                        </div>
                        {{ form.original_price.errors }}
                      </div>
                    </div>
                  </div>

                  <div class="mb-2">
                    <div class="d-flex align-items-start">
                      <div class="form-check me-2">
                        {{ form.poster_available }}
                      </div>
                      <div class="flex-grow-1">
                        <label class="form-label mb-1">Printed poster price</label>
                        <div class="d-flex align-items-center">
                          {{ form.poster_price }}
                          <div class="ms-2 small text-muted">{{ form.currency }}</div>
                        </div>
                        {{ form.poster_price.errors }}
                      </div>
                    </div>
                  </div>

                  <div class="mb-2">
                    <div class="d-flex align-items-start">
                      <div class="form-check me-2">
                        {{ form.digital_available }}
                      </div>
                      <div class="flex-grow-1">
                        <label class="form-label mb-1">Digital copy price</label>
                        <div class="d-flex align-items-center">
                          {{ form.digital_price }}
                          <div class="ms-2 small text-muted">{{ form.currency }}</div>
                        </div>
                        {{ form.digital_price.errors }}
                      </div>
                    </div>
                  </div>

                  <div class="mb-3">
                    {{ form.depth_cm.label_tag }}
                    {{ form.depth_cm }}
                    {{ form.depth_cm.errors }}
                  </div>

                    <div class="mt-3 d-flex">
                      <button type="submit" class="btn btn-primary">{% if edit %}Save changes{% else %}Create artwork{% endif %}</button>
                      <a class="btn-back btn-back--owner ms-2" href="{% url 'owner_app:art_list' %}">Cancel</a>
                    </div>
                  </div>
                </div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
{% endblock %}
