{% extends 'base.html' %}

{% block content %}
  <div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-3" id="Add-artwork">
      <h1>Artwork</h1>
      {% if request.user.is_superuser %}
        <a class="btn btn-primary" href="{% url 'owner_app:create_art' %}">Add New Artwork</a>
      {% endif %}
    </div>
  

    {% for group in grouped_collections %}
      <h4 class="mt-4">{{ group.collection.name }}</h4>
      <div class="row mb-3" id="card-row">
        {% for art in group.arts %}
          <div class="col-6 col-sm-4 col-md-3 mb-3">
            <div class="card small-card h-100">
              {% if art.image %}
                <img src="{{ art.image.url }}" class="card-img-top" alt="{{ art.title }}" style="height:140px; object-fit:cover;">
              {% else %}
                <div class="card-img-top bg-light" style="height:140px;"></div>
              {% endif %}
              <div class="card-body p-2 d-flex flex-column">
                <h6 class="card-title mb-1">{{ art.title }}</h6>
                <div class="mt-auto d-flex justify-content-between align-items-center" id="card-btn">
                  <div class="d-flex gap-1">
                    <a class="btn btn-sm btn-outline-secondary" href="{% url 'owner_app:edit_art' art.pk %}">Edit</a>
                    <form method="post" action="{% url 'owner_app:delete_art' art.pk %}" style="display:inline-block;">
                      {% csrf_token %}
                      <button class="btn btn-sm btn-outline-danger" type="submit">Delete</button>
                    </form>
                  </div>
                  <form method="post" action="{% url 'owner_app:toggle_featured_art' art.pk %}" class="mt-2">
                    {% csrf_token %}
                    <div class="form-check form-switch mb-0">
                      <input class="form-check-input" type="checkbox" role="switch" id="featured-{{ art.pk }}" name="is_featured" {% if art.is_featured %}checked{% endif %} onchange="this.form.submit()">
                      <label class="form-check-label small ms-1" for="featured-{{ art.pk }}">Featured</label>
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
        {% empty %}
          <p class="text-muted">No artworks in this collection yet.</p>
        {% endfor %}
      </div>
    {% endfor %}
  </div>

  <style>
    @media (min-width: 300px) {
      #card-btn{
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }
      
    }

    @media (min-width: 547px) {
      #card-row {
        flex-direction: row;
      }
    }
    </style>
{% endblock %}
